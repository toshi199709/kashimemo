<% readonly = local_assigns.key?(:readonly) ? local_assigns[:readonly] : false %>

<%= form_with model: post, local: true do |f| %>
  <div class="container">
    <div class="left-column">
      <iframe id="youtube-frame" width="100%" height="315"
              src=""
              frameborder="0"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
              allowfullscreen>
      </iframe>

      <%= f.label :lyrics, "Ê≠åË©û" %><br>
      <%= f.text_area :lyrics, id: "post_lyrics", class: "lyrics-box", rows: 10, readonly: (readonly ? true : nil) %>
    </div>

    <div class="right-column">
      <div class="url-input-wrapper">
        <%= f.label :title, "Êõ≤ÂêçÔºà„Çø„Ç§„Éà„É´Ôºâ" %>
        <%= f.text_field :title, id: "post_title", class: "url-input", readonly: (readonly ? true : nil) %>

        <%= f.label :video_url, "YouTube„ÅÆURL" %>
        <%= f.text_field :video_url, id: "post_video_url", class: "url-input", readonly: (readonly ? true : nil) %>

        <% unless readonly %>
          <button type="button" id="load-video-btn" class="load-btn">Ë™≠„ÅøËæº„ÇÄ</button>
        <% end %>
      </div>

      <%= f.label :memo, "„É°„É¢" %><br>
      <%= f.text_area :memo, id: "post_memo", class: "memo-box", rows: 10, readonly: (readonly ? true : nil) %>
    </div>
  </div>

  <% unless readonly %>
    <div style="margin-top: 20px;">
      <%= f.label :is_public, "ÂÖ¨Èñã„Åô„Çã" %>
      <%= f.check_box :is_public, id: "post_is_public" %>
    </div>

    <div style="text-align: center; margin-top: 20px; display: flex; justify-content: center; gap: 12px; flex-wrap: wrap;">
      <%= link_to "‚Üê Êàª„Çã", session[:return_to] || mypage_path, class: "load-btn" %>
      <%= f.submit(post.persisted? ? "Êõ¥Êñ∞„Åô„Çã" : "‰øùÂ≠ò„Åô„Çã", class: "load-btn") %>

      <% if post.persisted? %>
        <%= link_to "üóëÔ∏è ÂâäÈô§„Åô„Çã", post_path(post), method: :delete,
              data: { confirm: "Êú¨ÂΩì„Å´ÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü" },
              class: "load-btn" %>
      <% end %>
    </div>
  <% else %>
    <div style="text-align: center; margin-top: 20px;">
      <%= link_to "‚Üê Êàª„Çã", root_path, class: "load-btn" %>
    </div>
  <% end %>
<% end %>
