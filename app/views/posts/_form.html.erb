<% readonly = local_assigns[:readonly] || false %>

<%= form_with model: post, local: true do |f| %>
  <div class="container">
    <div class="left-column">
      <iframe id="youtube-frame" width="100%" height="315"
              src="<%= youtube_embed_url(post.video_url) %>"
              frameborder="0"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
              allowfullscreen>
      </iframe>

      <%= f.label :lyrics, "Ê≠åË©û" %><br>
      <%= f.text_area :lyrics, class: "lyrics-box", rows: 10, readonly: readonly %>
    </div>

    <div class="right-column">
      <div class="url-input-wrapper">
        <%= f.label :title, "Êõ≤ÂêçÔºà„Çø„Ç§„Éà„É´Ôºâ" %>
        <%= f.text_field :title, class: "url-input", readonly: readonly %>

        <%= f.label :video_url, "YouTube„ÅÆURL" %>
        <%= f.text_field :video_url, id: "youtube-url", class: "url-input", readonly: readonly %>

        <% unless readonly %>
          <button type="button" id="load-video-btn" class="load-btn">Ë™≠„ÅøËæº„ÇÄ</button>
        <% end %>
      </div>

      <%= f.label :memo, "„É°„É¢" %><br>
      <%= f.text_area :memo, class: "memo-box", rows: 10, readonly: readonly %>
    </div>
  </div>

  <% unless readonly %>
    <div style="margin-top: 20px;">
      <%= f.label :is_public, "ÂÖ¨Èñã„Åô„Çã" %>
      <%= f.check_box :is_public %>
    </div>

    <!-- ‚úÖ „Éú„Çø„É≥3„Å§„ÇíÁµ±‰∏Ä„Åó„Å¶‰∏≠Â§Æ„Å´ÈÖçÁΩÆ -->
    <div style="text-align: center; margin-top: 20px; display: flex; justify-content: center; gap: 12px; flex-wrap: wrap;">
      <!-- Êàª„Çã„É™„É≥„ÇØ -->
      <%= link_to "‚Üê Êàª„Çã", session[:return_to] || mypage_path, class: "load-btn" %>

      <!-- Êõ¥Êñ∞ or ‰øùÂ≠ò„Éú„Çø„É≥ -->
      <%= f.submit(post.persisted? ? "Êõ¥Êñ∞„Åô„Çã" : "‰øùÂ≠ò„Åô„Çã", class: "load-btn") %>

      <!-- ÂâäÈô§„É™„É≥„ÇØÔºàÁ∑®ÈõÜ„ÅÆ„Å®„Åç„Å†„ÅëÔºâ -->
      <% if post.persisted? %>
        <%= link_to "üóëÔ∏è ÂâäÈô§„Åô„Çã", post_path(post), method: :delete,
              data: { confirm: "Êú¨ÂΩì„Å´ÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü" },
              class: "load-btn" %>
      <% end %>
    </div>
  <% end %>
<% end %>
